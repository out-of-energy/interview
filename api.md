### 面试模块：API 设计与 RESTful 规范实战（建议时长 15 分钟）

**面试官（你）：**
“我看到你的项目里面有提到系统之间的对接集成。你的简历提到熟悉 RESTful 规范和 API 设计。
我们公司是做产品研发的，对 API 的**语义清晰度**和**版本兼容性**要求很高。我想通过一个具体场景看看你的设计思路。”

#### **第一层：考察 RESTful 核心语义（动词 vs 名词）**

**场景设定：**
“假设我们要为一个电商或物资管理系统设计一个**‘取消订单’**的接口。”

**面试官（你）：**
“**Q1：你会把这个接口的 URL 和 HTTP Method 设计成什么样？**”

* **🕵️‍♂️ 你的观察点（以此区分段位）：**
* **初级（RPC 风格）：** `POST /api/cancelOrder?id=123` 或者 `GET /api/order/delete?id=123`。
* *评价：* 这是典型的“把 HTTP 当传输通道”，而不是 REST 风格。


* **中级（标准 REST）：** `DELETE /api/orders/123`。
* *评价：* 合理，但“取消”不一定代表物理删除，可能是状态变更。


* **高级（资源状态视角）：** `PATCH /api/orders/123`，Body 带上 `{ "status": "CANCELLED" }`。
* *评价：* **这是最地道的。** 他理解 REST 的本质是“对资源状态的操作”，而不是“动作的映射”。





---

#### **第二层：考察复杂查询与规范（GET 的局限性）**

**面试官（你）：**
“好，现在需求变复杂了。我们需要设计一个**‘高级搜索接口’**。
用户需要筛选：‘过去 7 天下单’ **且** ‘金额大于 1000’ **且** ‘状态为已发货’ 的订单，甚至可能包含几十个筛选条件。
**Q2：对于这种参数极多、结构复杂的查询，你会怎么设计接口？还是坚持用 GET 请求吗？**”

* **🕵️‍♂️ 你的观察点：**
* **陷阱：** 坚持用 GET，然后把 URL 拼得几千字长，或者把 JSON 放进 URL 参数里。
* **高级回答：**
1. **实事求是：** “理论上查询应该用 GET，但参数太复杂会碰到 URL 长度限制。”
2. **解决方案：** “我会设计一个 `POST /api/orders/search` 接口，把筛选条件放在 Body 里。”
3. **补充：** “但我会注意，这个 POST 只是为了查询，不修改数据。如果涉及到缓存，可能需要特殊处理。”





---

#### **第三层：考察错误处理与 HTTP 状态码**

**面试官（你）：**
“接口调用总会出错。假设用户传了一个不存在的 `order_id` 来查询。
**Q3：你的接口会返回什么？是返回 HTTP 200 OK 然后在 Body 里写 `code: 404`，还是直接返回 HTTP 404 状态码？为什么？**”

* **🕵️‍♂️ 你的观察点：**
* **土法炼钢（减分）：** “我们以前都统一返回 200，前端好处理。”（这是很多国内老系统的通病，但在 RESTful 规范中是反模式，会导致监控系统无法通过 HTTP 状态码识别错误）。
* **规范意识（加分）：** “应该利用 HTTP 协议本身的状态码。资源不存在用 `404`，权限不够用 `403`，未登录用 `401`，参数校验失败用 `400`。这样网关层（Nginx/Gateway）和监控系统才能正确统计成功率。”



---

#### **第四层：考察版本控制与向前兼容（Senior 的核心价值）**

**面试官（你）：**
“最后一个问题，关于**API 的演进**。
现在的 `/api/orders/123` 接口返回的 `user` 字段是一个字符串（用户名）。
下个月业务变了，App 端需要 `user` 字段变成一个对象（包含 id, name, avatar）。但旧版本的 App 还在用户手机上，不能崩。
**Q4：你会如何平滑地升级这个 API，既满足新需求，又不影响旧用户？**”

* **🕵️‍♂️ 你的观察点：**
* **方案 A（URL 版本法）：** 新开一个 `/api/v2/orders/123`。
* *评价：* 最直观，最稳妥，但维护成本高。


* **方案 B（扩展字段法）：** 保留 `user` 字段不动，新增一个 `userInfo` 对象字段。
* *评价：* 实用主义，通过数据冗余换兼容。


* **方案 C（Header 版本法）：** 在 HTTP Header 里带上 `Accept-Version: v2`。
* *评价：* 比较学术，RESTful 纯度高，但调试稍微麻烦。


* **❌ 淘汰回答：** “直接改了，通知前端改代码。”（完全没有线上运维意识）。



---

### 总结：在这个模块你想听到什么？

对于一个 **10 年经验** 且在 **国网体系（通常接口规范很严）** 呆过的人，你的期待值应该是：

1. **不要把 HTTP 仅仅当成 TCP 用：** 知道 Method、Status Code 的各种含义。
2. **以“资源”为中心思考：** URL 里全是名词（users, orders），而不是动词（getUser, createOrder）。
3. **敬畏兼容性：** 在修改接口时，第一反应是“会不会把旧客户端搞挂”。

如果这 4 个问题他能对答如流，说明他在 API 设计上是有**架构师思维**的，完全符合你公司对规范的要求。